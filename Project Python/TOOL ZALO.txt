CÃCH CHáº Y PROJECT
1. Chá»n cd Ä‘Ãºng folder project vd: cd tool-test
2. Cháº¡y mÃ´i trÆ°á»ng áº£o: venv\Scripts\activate
3. Cháº¡y dá»± Ã¡n: python zalo.py




-- ÄÃ‚Y LÃ€ CODE ZALO ÄÃƒ Káº¾T Há»¢P EXCEL -- NHANH X10

import pyautogui            # ThÆ° viá»‡n Ä‘iá»u khiá»ƒn chuá»™t, bÃ n phÃ­m tá»± Ä‘á»™ng
import pygetwindow as gw    # ThÆ° viá»‡n Ä‘á»ƒ láº¥y danh sÃ¡ch vÃ  thao tÃ¡c cá»­a sá»• á»©ng dá»¥ng
import subprocess           # DÃ¹ng Ä‘á»ƒ má»Ÿ á»©ng dá»¥ng (Excel, Zalo)
import time                 # ThÆ° viá»‡n dÃ¹ng Ä‘á»ƒ delay giá»¯a cÃ¡c thao tÃ¡c
import pyperclip            # ThÆ° viá»‡n Ä‘á»ƒ thao tÃ¡c vá»›i clipboard (copy/paste nhanh, an toÃ n)

# ========== Cáº¤U HÃŒNH ==========
excel_path = r"D:\Project Python\tool-test\dsUser.xlsx"  # ÄÆ°á»ng dáº«n file Excel chá»©a danh sÃ¡ch SÄT
zalo_path = r"C:\Users\bibih\AppData\Local\Programs\Zalo\Zalo.exe"  # ÄÆ°á»ng dáº«n á»©ng dá»¥ng Zalo
start_row = 2        # DÃ²ng báº¯t Ä‘áº§u (bá» dÃ²ng tiÃªu Ä‘á»)
end_row = 30         # DÃ²ng káº¿t thÃºc (sá»‘ dÃ²ng cáº§n kiá»ƒm tra)

# ========== KHá»I Äá»˜NG á»¨NG Dá»¤NG ==========
subprocess.Popen(["start", "excel", excel_path], shell=True)  # Má»Ÿ Excel
subprocess.Popen(zalo_path)                                    # Má»Ÿ Zalo
time.sleep(3)  # Chá» á»©ng dá»¥ng load xong (giáº£m tá»« 5s â†’ 3s Ä‘á»ƒ nhanh hÆ¡n)

# ========== HÃ€M Há»– TRá»¢ ==========

# Chuyá»ƒn sang cá»­a sá»• á»©ng dá»¥ng theo tiÃªu Ä‘á» (Excel hoáº·c Zalo)
def switch_to_window(title):
    windows = gw.getWindowsWithTitle(title)
    if windows:
        win = windows[0]
        win.activate()   # ÄÆ°a cá»­a sá»• lÃªn trÆ°á»›c
        win.maximize()   # PhÃ³ng to toÃ n mÃ n hÃ¬nh
        time.sleep(0.3)  # Delay ngáº¯n Ä‘á»ƒ Ä‘áº£m báº£o cá»­a sá»• Ä‘Ã£ sáºµn sÃ ng

# Äi tá»›i vÃ  chá»n Ã´ Excel cá»¥ thá»ƒ (vd: C5, F10)
def goto_and_focus_cell(cell_ref):
    pyautogui.hotkey("ctrl", "g")      # Má»Ÿ há»™p thoáº¡i "Go To"
    time.sleep(0.1)
    pyperclip.copy(cell_ref)           # Copy Ä‘á»‹a chá»‰ Ã´ vÃ o clipboard
    pyautogui.hotkey("ctrl", "v")      # DÃ¡n vÃ o há»™p thoáº¡i
    pyautogui.press("enter")           # Nháº£y Ä‘áº¿n Ã´ chá»‰ Ä‘á»‹nh
    time.sleep(0.1)
    pyautogui.press("esc")             # ThoÃ¡t khá»i há»™p thoáº¡i
    time.sleep(0.1)

# XÃ³a Ã´ tÃ¬m kiáº¿m trong Zalo trÆ°á»›c khi tÃ¬m má»›i
def clear_zalo_search():
    pyautogui.moveTo(147, 70, duration=0)  # Di chuyá»ƒn nhanh Ä‘áº¿n Ã´ tÃ¬m kiáº¿m Zalo (tá»a Ä‘á»™ cá»‘ Ä‘á»‹nh)
    pyautogui.click()                      # Click vÃ o Ã´
    pyautogui.hotkey("ctrl", "a")          # Chá»n háº¿t ná»™i dung
    pyautogui.press("delete")              # XÃ³a ná»™i dung cÅ©
    time.sleep(0.1)

# ========== Báº®T Äáº¦U KIá»‚M TRA DANH SÃCH SÄT ==========
for row in range(start_row, end_row + 1):
    cell_sdt = f"C{row}"           # Ã” chá»©a sá»‘ Ä‘iá»‡n thoáº¡i (cá»™t C)
    cell_trang_thai = f"F{row}"    # Ã” ghi tráº¡ng thÃ¡i káº¿t quáº£ (cá»™t F)

    # Láº¥y sá»‘ Ä‘iá»‡n thoáº¡i tá»« Excel
    switch_to_window("Excel")             # Chuyá»ƒn sang Excel
    goto_and_focus_cell(cell_sdt)         # Di chuyá»ƒn tá»›i Ã´ chá»©a SÄT
    pyautogui.hotkey("ctrl", "c")         # Copy SÄT vÃ o clipboard
    time.sleep(0.1)
    sdt = pyperclip.paste().strip()       # Láº¥y SÄT vÃ  xÃ³a khoáº£ng tráº¯ng

    if not sdt:
        continue  # Bá» qua náº¿u Ã´ rá»—ng

    print(f"ğŸ” Äang kiá»ƒm tra: {sdt}")

    # TÃ¬m kiáº¿m trong Zalo
    switch_to_window("Zalo")              # Chuyá»ƒn sang Zalo
    clear_zalo_search()                   # XÃ³a tÃ¬m kiáº¿m cÅ©
    pyperclip.copy(sdt)                   # Copy SÄT
    pyautogui.hotkey("ctrl", "v")         # DÃ¡n vÃ o Ã´ tÃ¬m kiáº¿m Zalo
    time.sleep(1.5)                       # Chá» Zalo hiá»‡n káº¿t quáº£ (giáº£m tá»« 2s â†’ 1.5s)

    # Kiá»ƒm tra hÃ¬nh áº£nh bÃ¡o khÃ´ng tÃ¬m tháº¥y hoáº·c chÆ°a Ä‘Äƒng kÃ½
    try:
        not_found = pyautogui.locateOnScreen("not_found.png", confidence=0.6)
    except:
        not_found = None

    try:
        not_registered = pyautogui.locateOnScreen("not_registered.png", confidence=0.6)
    except:
        not_registered = None

    # Xá»­ lÃ½ káº¿t quáº£
    if not_registered:
        print(f"âš ï¸ SÄT chÆ°a Ä‘Äƒng kÃ½ hoáº·c khÃ´ng cho phÃ©p tÃ¬m kiáº¿m: {sdt}")
        status = "SÄT chÆ°a Ä‘Äƒng kÃ½"
    elif not_found:
        print(f"âŒ KhÃ´ng tÃ¬m tháº¥y ngÆ°á»i nÃ y: {sdt}")
        status = "KhÃ´ng tÃ¬m tháº¥y ngÆ°á»i nÃ y"
    else:
        print(f"âœ… TÃ¬m tháº¥y: {sdt}")
        # Click vÃ o káº¿t quáº£ tÃ¬m tháº¥y Ä‘á»ƒ xÃ¡c nháº­n
        pyautogui.moveTo(140, 235, duration=0.05)
        pyautogui.click()
        time.sleep(0.5)
        status = "X"

    # Ghi káº¿t quáº£ trá»Ÿ láº¡i Excel
    switch_to_window("Excel")                 # Quay láº¡i Excel
    goto_and_focus_cell(cell_trang_thai)      # Di chuyá»ƒn Ä‘áº¿n Ã´ ghi káº¿t quáº£
    pyperclip.copy(status)                    # Copy ná»™i dung tráº¡ng thÃ¡i
    pyautogui.hotkey("ctrl", "v")             # DÃ¡n vÃ o Ã´
    pyautogui.press("enter")                  # XÃ¡c nháº­n
    print(f"âœ”ï¸ ÄÃ£ ghi '{status}' vÃ o {cell_trang_thai}")

    time.sleep(0.3)  # Delay nháº¹ trÆ°á»›c khi qua dÃ²ng tiáº¿p theo

print("ğŸ‰ ÄÃ£ hoÃ n thÃ nh kiá»ƒm tra táº¥t cáº£ sá»‘ Ä‘iá»‡n thoáº¡i.")













-- ÄÃ‚Y LÃ€ CODE ZALO ÄÃƒ Káº¾T Há»¢P EXCEL -- CHáº Y BÃŒNH THÆ¯á»œNG, á»”N Äá»ŠNH

import pyautogui            # ThÆ° viá»‡n Ä‘iá»u khiá»ƒn chuá»™t vÃ  bÃ n phÃ­m
import pygetwindow as gw    # ThÆ° viá»‡n Ä‘á»ƒ láº¥y vÃ  chuyá»ƒn Ä‘á»•i giá»¯a cÃ¡c cá»­a sá»•
import subprocess           # DÃ¹ng Ä‘á»ƒ má»Ÿ file, á»©ng dá»¥ng
import time                 # ThÆ° viá»‡n Ä‘á»ƒ xá»­ lÃ½ thá»i gian, sleep
import pyperclip            # DÃ¹ng Ä‘á»ƒ thao tÃ¡c vá»›i clipboard (copy/paste vÄƒn báº£n)

# ========== Cáº¤U HÃŒNH ==========
excel_path = r"D:\Project Python\tool-test\dsUser.xlsx"  # ÄÆ°á»ng dáº«n file Excel chá»©a danh sÃ¡ch SÄT
zalo_path = r"C:\Users\bibih\AppData\Local\Programs\Zalo\Zalo.exe"  # ÄÆ°á»ng dáº«n tá»›i á»©ng dá»¥ng Zalo
start_row = 2      # DÃ²ng báº¯t Ä‘áº§u (bá» dÃ²ng tiÃªu Ä‘á»)
end_row = 30       # DÃ²ng káº¿t thÃºc (tÃ¹y chá»‰nh theo sá»‘ dÃ²ng dá»¯ liá»‡u thá»±c táº¿)

# ========== Má» EXCEL VÃ€ ZALO ==========
# Má»Ÿ file Excel
subprocess.Popen(["start", "excel", excel_path], shell=True)

# Má»Ÿ á»©ng dá»¥ng Zalo
subprocess.Popen(zalo_path)

# Chá» cáº£ 2 á»©ng dá»¥ng khá»Ÿi Ä‘á»™ng xong
time.sleep(5)

# ========== HÃ€M Há»– TRá»¢ ==========

# Chuyá»ƒn sang cá»­a sá»• theo tiÃªu Ä‘á»
def switch_to_window(title):
    windows = gw.getWindowsWithTitle(title)
    if windows:
        win = windows[0]
        win.activate()    # Chuyá»ƒn cá»­a sá»• lÃªn trÆ°á»›c
        win.maximize()    # PhÃ³ng to cá»­a sá»•
        time.sleep(1)

# Äi tá»›i vÃ  chá»n Ã´ Excel theo Ä‘á»‹a chá»‰ (vd: C5, F7...)
def goto_and_focus_cell(cell_ref):
    pyautogui.hotkey("ctrl", "g")     # Má»Ÿ há»™p thoáº¡i "Go to"
    time.sleep(0.2)
    pyperclip.copy(cell_ref)         # Copy Ä‘á»‹a chá»‰ Ã´ vÃ o clipboard
    pyautogui.hotkey("ctrl", "v")    # DÃ¡n vÃ o há»™p thoáº¡i
    pyautogui.press("enter")         # Nháº£y Ä‘áº¿n Ã´ chá»‰ Ä‘á»‹nh
    time.sleep(0.2)
    pyautogui.press("esc")           # ThoÃ¡t khá»i cháº¿ Ä‘á»™ "go to"
    time.sleep(0.2)

# XÃ³a ná»™i dung Ä‘ang cÃ³ trong Ã´ tÃ¬m kiáº¿m cá»§a Zalo
def clear_zalo_search():
    pyautogui.moveTo(147, 70, duration=0.3)  # Di chuyá»ƒn chuá»™t Ä‘áº¿n Ã´ tÃ¬m kiáº¿m (tá»a Ä‘á»™ cá»‘ Ä‘á»‹nh)
    pyautogui.click()                        # Click vÃ o Ã´
    pyautogui.hotkey("ctrl", "a")            # Chá»n háº¿t ná»™i dung
    pyautogui.press("delete")                # XÃ³a
    time.sleep(0.3)

# ========== DUYá»†T DANH SÃCH Sá» ÄIá»†N THOáº I ==========
for row in range(start_row, end_row + 1):
    cell_sdt = f"C{row}"           # Äá»‹a chá»‰ Ã´ chá»©a SÄT (cá»™t C)
    cell_trang_thai = f"F{row}"    # Äá»‹a chá»‰ Ã´ ghi tráº¡ng thÃ¡i (cá»™t F)

    # Láº¥y sá»‘ Ä‘iá»‡n thoáº¡i tá»« Excel
    switch_to_window("Excel")             # Chuyá»ƒn sang cá»­a sá»• Excel
    goto_and_focus_cell(cell_sdt)         # Di chuyá»ƒn Ä‘áº¿n Ã´ chá»©a SÄT
    pyautogui.hotkey("ctrl", "c")         # Copy ná»™i dung Ã´
    time.sleep(0.3)
    sdt = pyperclip.paste().strip()       # DÃ¡n vÃ  loáº¡i bá» khoáº£ng tráº¯ng

    if not sdt:
        continue  # Náº¿u Ã´ trá»‘ng thÃ¬ bá» qua

    print(f"ğŸ” Äang kiá»ƒm tra: {sdt}")

    # TÃ¬m kiáº¿m trong Zalo
    switch_to_window("Zalo")              # Chuyá»ƒn sang cá»­a sá»• Zalo
    clear_zalo_search()                   # XÃ³a tÃ¬m kiáº¿m cÅ©
    pyperclip.copy(sdt)                   # Copy sá»‘ Ä‘iá»‡n thoáº¡i
    pyautogui.hotkey("ctrl", "v")         # DÃ¡n vÃ o Ã´ tÃ¬m kiáº¿m Zalo
    time.sleep(2)                         # Äá»£i káº¿t quáº£ hiá»‡n lÃªn

    # TÃ¬m áº£nh thÃ´ng bÃ¡o khÃ´ng tÃ¬m tháº¥y
    try:
        not_found = pyautogui.locateOnScreen("not_found.png", confidence=0.6)
    except:
        not_found = None

    # TÃ¬m áº£nh thÃ´ng bÃ¡o chÆ°a Ä‘Äƒng kÃ½
    try:
        not_registered = pyautogui.locateOnScreen("not_registered.png", confidence=0.6)
    except:
        not_registered = None

    # PhÃ¢n loáº¡i káº¿t quáº£ tÃ¬m kiáº¿m
    if not_registered:
        print(f"âš ï¸ SÄT chÆ°a Ä‘Äƒng kÃ½ hoáº·c khÃ´ng cho phÃ©p tÃ¬m kiáº¿m: {sdt}")
        status = "SÄT chÆ°a Ä‘Äƒng kÃ½"
    elif not_found:
        print(f"âŒ KhÃ´ng tÃ¬m tháº¥y ngÆ°á»i nÃ y: {sdt}")
        status = "KhÃ´ng tÃ¬m tháº¥y ngÆ°á»i nÃ y"
    else:
        print(f"âœ… TÃ¬m tháº¥y: {sdt}")
        # Click vÃ o ngÆ°á»i dÃ¹ng Zalo Ä‘á»ƒ xÃ¡c nháº­n
        pyautogui.moveTo(140, 235, duration=0.3)  # Tá»a Ä‘á»™ káº¿t quáº£ tÃ¬m tháº¥y
        pyautogui.click()
        time.sleep(1)
        status = "X"

    # Ghi káº¿t quáº£ vÃ o Ã´ tÆ°Æ¡ng á»©ng trong Excel
    switch_to_window("Excel")                 # Chuyá»ƒn láº¡i sang Excel
    goto_and_focus_cell(cell_trang_thai)      # Di chuyá»ƒn Ä‘áº¿n Ã´ ghi tráº¡ng thÃ¡i
    pyperclip.copy(status)                    # Copy káº¿t quáº£
    pyautogui.hotkey("ctrl", "v")             # DÃ¡n vÃ o Ã´
    pyautogui.press("enter")                  # XÃ¡c nháº­n
    print(f"âœ”ï¸ ÄÃ£ ghi '{status}' vÃ o {cell_trang_thai}")

    time.sleep(1)

print("ğŸ‰ ÄÃ£ hoÃ n thÃ nh kiá»ƒm tra táº¥t cáº£ sá»‘ Ä‘iá»‡n thoáº¡i.")


















-- ÄÃ‚Y LÃ€ CODE ZALO KHI CHÆ¯A CÃ“ EXCEL --

# TOOL AUTO TÃŒM Rá»’I Gá»¬I TIN NHáº®N TRONG ZALO
import pyautogui
import pygetwindow as gw
import subprocess
import time
import pyperclip  # DÃ¹ng Ä‘á»ƒ xá»­ lÃ½ clipboard

# Má»Ÿ Zalo (náº¿u chÆ°a má»Ÿ)
subprocess.Popen(r"C:\Users\bibih\AppData\Local\Programs\Zalo\Zalo.exe")
time.sleep(1)

# TÃ¬m cá»­a sá»• Zalo, Ä‘Æ°a cá»­a sá»• Zalo ra phÃ­a trÆ°á»›c vÃ  phÃ³ng to
windows = gw.getWindowsWithTitle("Zalo")
if not windows:
    print("âŒ KhÃ´ng tÃ¬m tháº¥y cá»­a sá»• Zalo.")
    exit()

zalo_window = windows[0]
zalo_window.activate()
zalo_window.maximize()
time.sleep(1)

# HÃ m tÃ¬m kiáº¿m vÃ  xá»­ lÃ½ káº¿t quáº£
def tim_kiem_va_click(ten_can_tim):
    # Click vÃ o Ã´ tÃ¬m kiáº¿m
    pyautogui.moveTo(147, 70, duration=0.5)
    pyautogui.click()
    # XÃ³a ná»™i dung cÅ©
    pyautogui.hotkey("ctrl", "a")
    pyautogui.press("delete")
    time.sleep(0.2)
    # DÃ¡n ná»™i dung má»›i
    pyperclip.copy(ten_can_tim)
    pyautogui.hotkey("ctrl", "v")
    time.sleep(2)

    try:
        not_found = pyautogui.locateOnScreen("not_found.png", confidence=0.6)
        if not_found:
            print(f"âŒ KhÃ´ng tÃ¬m tháº¥y káº¿t quáº£ vá»›i tá»« khÃ³a: {ten_can_tim}")
            return False
        else:
            print(f"âœ… TÃ¬m tháº¥y káº¿t quáº£ vá»›i tá»« khÃ³a: {ten_can_tim}")
            pyautogui.moveTo(140, 235, duration=0.5)
            pyautogui.click()
            print("ğŸ–±ï¸ ÄÃ£ click vÃ o káº¿t quáº£ tÃ¬m kiáº¿m.")
            return True
    except pyautogui.ImageNotFoundException:
        print("âœ… TÃ¬m tháº¥y káº¿t quáº£.")
        # TrÆ°á»ng há»£p nÃ y Ä‘Æ°á»£c hiá»ƒu lÃ  TÃŒM THáº¤Y (vÃ¬ khÃ´ng tÃ¬m ra hÃ¬nh áº£nh "khÃ´ng tÃ¬m tháº¥y")
        pyautogui.moveTo(140, 235, duration=0.5)
        pyautogui.click()
        print("ğŸ–±ï¸ ÄÃ£ click vÃ o káº¿t quáº£ tÃ¬m kiáº¿m.")
        return True

# Thá»­ tÃ¬m ngÆ°á»i Ä‘áº§u tiÃªn
tim_thay = tim_kiem_va_click("0908415553")

# Náº¿u khÃ´ng tÃ¬m tháº¥y thÃ¬ thá»­ tÃ¬m ngÆ°á»i khÃ¡c
if not tim_thay:
    print("ğŸ“­ ÄÃ£ xÃ³a vÃ  dÃ¡n ná»™i dung má»›i trong Ã´ tÃ¬m kiáº¿m.")
    tim_lai = tim_kiem_va_click("Ba")
    if not tim_lai:
        print("ğŸ“­ Váº«n khÃ´ng tÃ¬m tháº¥y káº¿t quáº£ sau khi tÃ¬m láº¡i.")

ÄÃ¢y lÃ  code cháº¡y á»•n cá»§a tui


